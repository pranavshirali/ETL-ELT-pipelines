[2025-05-23T12:35:15.695+0530] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-05-23T12:35:15.701+0530] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: elt_sales_stream_transformation.transform_sales_stream manual__2025-05-23T07:05:11.759844+00:00 [queued]>
[2025-05-23T12:35:15.705+0530] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: elt_sales_stream_transformation.transform_sales_stream manual__2025-05-23T07:05:11.759844+00:00 [queued]>
[2025-05-23T12:35:15.706+0530] {taskinstance.py:2865} INFO - Starting attempt 1 of 1
[2025-05-23T12:35:15.717+0530] {taskinstance.py:2888} INFO - Executing <Task(SQLExecuteQueryOperator): transform_sales_stream> on 2025-05-23 07:05:11.759844+00:00
[2025-05-23T12:35:15.721+0530] {standard_task_runner.py:72} INFO - Started process 20551 to run task
[2025-05-23T12:35:15.723+0530] {standard_task_runner.py:104} INFO - Running: ['airflow', 'tasks', 'run', 'elt_sales_stream_transformation', 'transform_sales_stream', 'manual__2025-05-23T07:05:11.759844+00:00', '--job-id', '168', '--raw', '--subdir', 'DAGS_FOLDER/elt_transformation_dag.py', '--cfg-path', '/tmp/tmp4qexu87r']
[2025-05-23T12:35:15.725+0530] {standard_task_runner.py:105} INFO - Job 168: Subtask transform_sales_stream
[2025-05-23T12:35:15.763+0530] {task_command.py:467} INFO - Running <TaskInstance: elt_sales_stream_transformation.transform_sales_stream manual__2025-05-23T07:05:11.759844+00:00 [running]> on host Voldemort.
[2025-05-23T12:35:15.831+0530] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='elt_sales_stream_transformation' AIRFLOW_CTX_TASK_ID='transform_sales_stream' AIRFLOW_CTX_EXECUTION_DATE='2025-05-23T07:05:11.759844+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-05-23T07:05:11.759844+00:00'
[2025-05-23T12:35:15.832+0530] {taskinstance.py:731} INFO - ::endgroup::
[2025-05-23T12:35:15.855+0530] {sql.py:306} INFO - Executing: 
        CREATE OR REPLACE TABLE AIRFLOW_DB.ELT_TRANSFORMED.SALES_STREAM_TRANSFORMED AS
        SELECT
            REGION,
            COUNTRY,
            "ITEM TYPE",
            "SALES CHANNEL",
            "ORDER PRIORITY",
            "ORDER DATE",
            "ORDER ID",
            "SHIP DATE",
            "UNITS SOLD",
            "UNIT PRICE",
            "UNIT COST",
            "TOTAL REVENUE",
            "TOTAL COST",
            "TOTAL PROFIT",
            CASE
                WHEN "ORDER PRIORITY" = 'H' THEN 'High'
                WHEN "ORDER PRIORITY" = 'L' THEN 'Low'
                WHEN "ORDER PRIORITY" = 'M' THEN 'Medium'
                WHEN "ORDER PRIORITY" = 'C' THEN 'Cold'
                ELSE "ORDER PRIORITY"
            END AS "ORDER_PRIORITY_DESC",
            DATEDIFF(
                'day',
                COALESCE(
                  TRY_TO_DATE("ORDER DATE", 'M/D/YYYY'),
                  TRY_TO_DATE("ORDER DATE", 'MM/DD/YYYY'),
                  TRY_TO_DATE("ORDER DATE", 'YYYY-MM-DD')
                ),
                COALESCE(
                  TRY_TO_DATE("SHIP DATE", 'M/D/YYYY'),
                  TRY_TO_DATE("SHIP DATE", 'MM/DD/YYYY'),
                  TRY_TO_DATE("SHIP DATE", 'YYYY-MM-DD')
                )
            ) AS "SHIPMENT_LEAD_TIME"
        FROM AIRFLOW_DB.PUBLIC."SALES STREAM";
        
[2025-05-23T12:35:15.859+0530] {base.py:84} INFO - Retrieving connection 'snowflake_con'
[2025-05-23T12:35:15.944+0530] {base.py:84} INFO - Retrieving connection 'snowflake_con'
[2025-05-23T12:35:15.945+0530] {connection.py:486} INFO - Snowflake Connector for Python Version: 3.15.0, Python Version: 3.10.12, Platform: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.35
[2025-05-23T12:35:15.945+0530] {connection.py:1391} INFO - Connecting to GLOBAL Snowflake domain
[2025-05-23T12:35:19.284+0530] {snowflake.py:521} INFO - Running statement: CREATE OR REPLACE TABLE AIRFLOW_DB.ELT_TRANSFORMED.SALES_STREAM_TRANSFORMED AS
        SELECT
            REGION,
            COUNTRY,
            "ITEM TYPE",
            "SALES CHANNEL",
            "ORDER PRIORITY",
            "ORDER DATE",
            "ORDER ID",
            "SHIP DATE",
            "UNITS SOLD",
            "UNIT PRICE",
            "UNIT COST",
            "TOTAL REVENUE",
            "TOTAL COST",
            "TOTAL PROFIT",
            CASE
                WHEN "ORDER PRIORITY" = 'H' THEN 'High'
                WHEN "ORDER PRIORITY" = 'L' THEN 'Low'
                WHEN "ORDER PRIORITY" = 'M' THEN 'Medium'
                WHEN "ORDER PRIORITY" = 'C' THEN 'Cold'
                ELSE "ORDER PRIORITY"
            END AS "ORDER_PRIORITY_DESC",
            DATEDIFF(
                'day',
                COALESCE(
                  TRY_TO_DATE("ORDER DATE", 'M/D/YYYY'),
                  TRY_TO_DATE("ORDER DATE", 'MM/DD/YYYY'),
                  TRY_TO_DATE("ORDER DATE", 'YYYY-MM-DD')
                ),
                COALESCE(
                  TRY_TO_DATE("SHIP DATE", 'M/D/YYYY'),
                  TRY_TO_DATE("SHIP DATE", 'MM/DD/YYYY'),
                  TRY_TO_DATE("SHIP DATE", 'YYYY-MM-DD')
                )
            ) AS "SHIPMENT_LEAD_TIME"
        FROM AIRFLOW_DB.PUBLIC."SALES STREAM";, parameters: None
[2025-05-23T12:35:19.284+0530] {sql.py:814} INFO - Running statement: CREATE OR REPLACE TABLE AIRFLOW_DB.ELT_TRANSFORMED.SALES_STREAM_TRANSFORMED AS
        SELECT
            REGION,
            COUNTRY,
            "ITEM TYPE",
            "SALES CHANNEL",
            "ORDER PRIORITY",
            "ORDER DATE",
            "ORDER ID",
            "SHIP DATE",
            "UNITS SOLD",
            "UNIT PRICE",
            "UNIT COST",
            "TOTAL REVENUE",
            "TOTAL COST",
            "TOTAL PROFIT",
            CASE
                WHEN "ORDER PRIORITY" = 'H' THEN 'High'
                WHEN "ORDER PRIORITY" = 'L' THEN 'Low'
                WHEN "ORDER PRIORITY" = 'M' THEN 'Medium'
                WHEN "ORDER PRIORITY" = 'C' THEN 'Cold'
                ELSE "ORDER PRIORITY"
            END AS "ORDER_PRIORITY_DESC",
            DATEDIFF(
                'day',
                COALESCE(
                  TRY_TO_DATE("ORDER DATE", 'M/D/YYYY'),
                  TRY_TO_DATE("ORDER DATE", 'MM/DD/YYYY'),
                  TRY_TO_DATE("ORDER DATE", 'YYYY-MM-DD')
                ),
                COALESCE(
                  TRY_TO_DATE("SHIP DATE", 'M/D/YYYY'),
                  TRY_TO_DATE("SHIP DATE", 'MM/DD/YYYY'),
                  TRY_TO_DATE("SHIP DATE", 'YYYY-MM-DD')
                )
            ) AS "SHIPMENT_LEAD_TIME"
        FROM AIRFLOW_DB.PUBLIC."SALES STREAM";, parameters: None
[2025-05-23T12:35:23.239+0530] {sql.py:823} INFO - Rows affected: 1
[2025-05-23T12:35:23.239+0530] {snowflake.py:534} INFO - Rows affected: 1
[2025-05-23T12:35:23.239+0530] {snowflake.py:535} INFO - Snowflake query id: 01bc8909-3201-a520-000d-39de000864ba
[2025-05-23T12:35:23.457+0530] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-05-23T12:35:23.458+0530] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=elt_sales_stream_transformation, task_id=transform_sales_stream, run_id=manual__2025-05-23T07:05:11.759844+00:00, execution_date=20250523T070511, start_date=20250523T070515, end_date=20250523T070523
[2025-05-23T12:35:23.490+0530] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-05-23T12:35:23.500+0530] {taskinstance.py:3900} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-05-23T12:35:23.501+0530] {local_task_job_runner.py:245} INFO - ::endgroup::
